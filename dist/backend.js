!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=require("express")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("bcryptjs")},function(e,t,n){const s=n(1);let o=new(0,s.Schema)({name:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},register_date:{type:String,default:Date.now}});e.exports=User=s.model("user",o)},function(e,t,n){const s=n(2);e.exports=(e,t,n)=>{const o=e.header("x-auth-token");if(!o)return t.status(401).json({msg:"No token, authorization denied"});try{const r=s.verify(o,process.env.JWT_SECRET);e.user=r,n()}catch(e){t.status(400).json({msg:"Token is not valid"})}}},function(e,t,n){(function(e){const t=n(0),s=t(),o=n(1),r=(n(3),n(2),n(7)),i=n(8),a=n(9),u=n(11),d=n(12),c=process.env.MONGODB_URI;o.connect(c,{useNewUrlParser:!0,useCreateIndex:!0,useFindAndModify:!1}).then(()=>console.log("db connected")).catch(e=>console.log(e.message));s.use(t.json()),s.get("/config.js",(e,t)=>{t.send("const NASA_API_KEY='"+process.env.NASA_API_KEY+"'")}),s.use("/api/users",i),s.use("/api/planets",a),s.use("/api/auth",u),s.use("/api/posts",d),s.use(t.static("client/dist")),s.get("*",(t,n)=>{n.sendFile(r.resolve(e,"client","dist","index.html"))}),s.listen(process.env.PORT||5e3,()=>{console.log(`>>> Listening on ${process.env.PORT||5e3}...`)})}).call(this,"")},function(e,t){e.exports=require("path")},function(e,t,n){const s=n(0).Router(),o=n(3),r=n(2),i=n(4);s.post("/",(e,t)=>{const{name:n,email:s,password:a}=e.body;n&&s&&a||t.status(400).json({msg:"Please enter all fields"}),i.findOne({email:s}).then(e=>{if(e)return t.status(400).json({msg:"User already exists"});const u=new i({name:n,email:s,password:a});o.genSalt(13,(e,n)=>{o.hash(u.password,n,(e,n)=>{if(e)throw e;u.password=n,u.save().then(e=>{r.sign({id:e.id},process.env.JWT_SECRET,{expiresIn:3600},(n,s)=>{if(n)throw n;t.json({token:s,user:{id:e.id,name:e.name,password:e.password}})})}).catch(e=>{t.status(400).json({msg:"Error saving user"})})})})}).catch(e=>t.status(400).json({msg:"Error creating user"}))}),e.exports=s},function(e,t,n){const s=n(0).Router(),o=(n(1),n(10));s.get("/",(e,t)=>{o.find().exec((e,n)=>{e&&t.end(e),t.json(n)})}),s.post("/",(e,t)=>{new o({name:e.body.name}).save().then(e=>t.json(e))}),s.delete("/:id",(e,t)=>{o.deleteOne({_id:e.params.id}).then(e=>e.json({success:!0})).catch(e=>t.json({success:!1}))}),e.exports=s},function(e,t,n){const s=n(1);let o=new(0,s.Schema)({name:{type:String,required:!0}});e.exports=User=s.model("planet",o)},function(e,t,n){const s=n(0).Router(),o=n(3),r=n(2),i=n(5),a=n(4);s.post("/",(e,t)=>{const{email:n,password:s}=e.body;n&&s||t.status(400).json({msg:"Please enter all fields"}),a.findOne({email:n}).then(e=>{if(!e)return t.status(400).json({msg:"User does not exist"});o.compare(s,e.password).then(n=>{if(!n)return t.status(401).json({msg:"Invalid credentials"});r.sign({id:e.id},process.env.JWT_SECRET,{expiresIn:3600},(n,s)=>{if(n)throw n;t.json({token:s,user:{id:e.id,name:e.name,email:e.email}})})})})}),s.get("/user",i,(e,t)=>{a.findById(e.user.id).select("-password").then(e=>t.json(e))}),e.exports=s},function(e,t,n){const s=n(0).Router(),o=n(13),r=n(5);s.post("/",r,(e,t)=>{const{title:n,body:s}=e.body,r=e.user.id;new o({title:n,body:s,authorId:r}).save().then(e=>{t.json(e)}).catch(e=>{t.status(400).json({msg:"Error saving post"})})}),s.get("/user",r,(e,t)=>{o.find({authorId:e.user.id}).exec((e,n)=>{e&&t.end(e),t.json(n)})}),s.delete("/:id",r,(e,t)=>{o.deleteOne({_id:e.params.id}).then(e=>e.json({success:!0})).catch(e=>t.json({success:!1}))}),s.patch("/edit",r,(e,t)=>{o.findByIdAndUpdate(e.body._id,{title:e.body.title,body:e.body.body},{new:!0}).then(e=>{t.json(e)}).catch(e=>t.status(400).json({msg:"Error updating post"}))}),e.exports=s},function(e,t,n){const s=n(1);let o=new(0,s.Schema)({authorId:{type:String,required:!0},title:{type:String,required:!0},body:{type:String,maxlength:5e3,required:!0},createdAt:{type:Date,default:Date.now}});e.exports=Post=s.model("post",o)}]);